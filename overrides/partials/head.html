{% raw %}
<!-- Prevent theme flash -->
<style>
  html, body {
    background-color: #151515 !important;
  }

    :root {
    --md-default-bg-color: #151515 !important;
    }

  html[data-theme="gold"],
  html[data-theme="red"],
  html[data-theme="purple"] {
    background-color: #151515 !important;
  }

  /* Also target .md-main and .md-header for flash prevention */
  html[data-theme="gold"] .md-main,
  html[data-theme="gold"] .md-header,
  html[data-theme="red"] .md-main,
  html[data-theme="red"] .md-header,
  html[data-theme="purple"] .md-main,
  html[data-theme="purple"] .md-header {
    background-color: #151515 !important;
  }
</style>

<!-- Set theme instantly -->
<script>
  // Immediately set the theme attribute to avoid flash
  document.documentElement.setAttribute(
    'data-theme',
    localStorage.getItem('selectedTheme') || 'gold'
  );
</script>

<!-- Load dynamic theme CSS -->
<script>
  try {
    const theme = localStorage.getItem('selectedTheme') || 'gold';
    const link = document.createElement('link');
    link.id = 'dynamic-theme-css';
    link.rel = 'stylesheet';
    link.href = `/many/assets/css/themes/${theme}.css`;
    document.head.appendChild(link);
  } catch (e) {
    console.error("Theme load error:", e);
  }
</script>
{% endraw %}
