{% block extrahead %}
  <base href="{{ base_url | default('/') }}">
  {{ super() }}
{% endblock %}

<!-- Set theme early to prevent flash -->
<script>
  const theme = localStorage.getItem('selectedTheme') || 'shiny';
  document.documentElement.setAttribute('data-theme', theme);
</script>

<!-- Critical style fixes for load flicker -->
<style>
  html, body {
    background-color: #151515 !important;
  }

  /* Flicker-free themed logo switching */
  [data-md-component="logo"] img {
    content: url("/many/assets/img/sl-logo.jpg");
  }
  html[data-theme="fire"] [data-md-component="logo"] img {
    content: url("/many/assets/img/slm-logo-fire.svg");
  }
  html[data-theme="water"] [data-md-component="logo"] img {
    content: url("/many/assets/img/logo-water.png");
  }
  html[data-theme="grass"] [data-md-component="logo"] img {
    content: url("/many/assets/img/logo-grass.png");
  }
  html[data-theme="dark"] [data-md-component="logo"] img {
    content: url("/many/assets/img/logo-dark.png");
  }
</style>
